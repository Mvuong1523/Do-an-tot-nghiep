### Test GHN Integration
### Sử dụng file này với REST Client extension trong VS Code

@baseUrl = http://localhost:8080
@token = YOUR_JWT_TOKEN_HERE

### 1. Tính phí ship (nội thành HN - miễn phí)
POST {{baseUrl}}/api/shipping/calculate-fee
Content-Type: application/json

{
  "province": "Hà Nội",
  "district": "Ba Đình",
  "weight": 1000,
  "value": 500000
}

### 2. Tính phí ship (ngoài HN - có phí)
POST {{baseUrl}}/api/shipping/calculate-fee
Content-Type: application/json

{
  "province": "Bắc Ninh",
  "district": "Từ Sơn",
  "weight": 1000,
  "value": 500000
}

### 3. Đặt hàng COD nội thành HN (KHÔNG tạo GHN)
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "province": "Hà Nội",
  "district": "Ba Đình",
  "ward": "Ngọc Hà",
  "address": "123 Đường ABC",
  "note": "Test nội thành HN - không tạo GHN",
  "shippingFee": 0,
  "paymentMethod": "COD"
}

### 4. Đặt hàng COD ngoài HN (CÓ tạo GHN)
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "province": "Bắc Ninh",
  "district": "Từ Sơn",
  "ward": "Đông Ngàn",
  "address": "456 Đường XYZ",
  "note": "Test ngoài HN - phải tạo GHN",
  "shippingFee": 30000,
  "paymentMethod": "COD"
}

### 5. Đặt hàng Online ngoài HN (CÓ tạo GHN, COD = 0)
POST {{baseUrl}}/api/orders
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "province": "Hải Phòng",
  "district": "Hồng Bàng",
  "ward": "Hoàng Văn Thụ",
  "address": "789 Đường DEF",
  "note": "Test online payment - GHN với COD = 0",
  "shippingFee": 35000,
  "paymentMethod": "SEPAY"
}

### 6. Xem trạng thái vận chuyển (Customer)
GET {{baseUrl}}/api/orders/123/shipping-status
Authorization: Bearer {{token}}

### 7. Xem trạng thái vận chuyển (Admin)
GET {{baseUrl}}/api/admin/orders/123/shipping-status
Authorization: Bearer {{token}}

### 8. Xem chi tiết đơn hàng
GET {{baseUrl}}/api/orders/123
Authorization: Bearer {{token}}

### 9. Test webhook GHN (simulate)
POST {{baseUrl}}/api/webhooks/ghn
Content-Type: application/json

{
  "orderCode": "GHNABCD1234",
  "status": "picked",
  "statusText": "Đã lấy hàng",
  "updatedDate": 1702368000,
  "currentWarehouse": "Kho Hà Nội",
  "description": "Đã lấy hàng thành công",
  "codAmount": 500000,
  "shippingFee": 30000,
  "partnerCode": "ORD20231212001"
}

### 10. Test webhook - Delivered
POST {{baseUrl}}/api/webhooks/ghn
Content-Type: application/json

{
  "orderCode": "GHNABCD1234",
  "status": "delivered",
  "statusText": "Đã giao hàng",
  "updatedDate": 1702454400,
  "description": "Giao hàng thành công",
  "codAmount": 500000,
  "shippingFee": 30000,
  "partnerCode": "ORD20231212001"
}

### 11. Test webhook - Returned
POST {{baseUrl}}/api/webhooks/ghn
Content-Type: application/json

{
  "orderCode": "GHNABCD1234",
  "status": "returned",
  "statusText": "Đã trả hàng",
  "updatedDate": 1702540800,
  "description": "Khách không nhận hàng",
  "reason": "Khách hủy đơn",
  "partnerCode": "ORD20231212001"
}

### 12. Lấy danh sách đơn hàng của tôi
GET {{baseUrl}}/api/orders/my-orders
Authorization: Bearer {{token}}

### 13. Admin - Xem tất cả đơn hàng
GET {{baseUrl}}/api/admin/orders?status=ALL&page=0&size=20
Authorization: Bearer {{token}}

### 14. Admin - Cập nhật trạng thái đơn hàng
PUT {{baseUrl}}/api/admin/orders/123/status
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "status": "SHIPPING"
}
